from abc import ABC
import sys

from django.core.exceptions import ImproperlyConfigured
from django.db.backends.base.creation import BaseDatabaseCreation
from django.db.backends.utils import strip_quotes
from django.db.backends.base.base import logger


class DatabaseCreation(BaseDatabaseCreation, ABC):
    def _quote_name(self, name):
        return self.connection.ops.quote_name(name)

    """
    Encapsulate backends-specific differences pertaining to creation and
    destruction of the test database.
    """
    
    def _execute_create_test_db(self, cursor, parameters, keepdb=False):
        # TODO: not supported in YDB, need to check details
        # cursor._connection.get_driver().scheme_client.make_directory("/local/test")
        return "/local"

    def _destroy_test_db(self, test_database_name, verbosity):
        # TODO: not supported in YDB, need to check details
        # self.connection._driver.scheme_client.remove_directory("/local/test")
        return None